@* CHNhu - 12/10/2025 - Sửa view cho trang chủ *@
@model List<core_23webc_gr6.Models.Product>

@functions {
	string GetFirstImage(string? images)
	{
		var imageList = new List<string>();
		if (images != null && images.Trim().StartsWith("["))
		{
			imageList = System.Text.Json.JsonSerializer.Deserialize<List<string>>(images) ?? new List<string>();
		}
		else if (!string.IsNullOrEmpty(images))
		{
			imageList = images.Split(',').Select(s => s.Trim()).ToList();
		}
		return imageList != null && imageList.Count > 0 ? imageList[0] : "default.jpg";
	}
}

<div class="slider-area">
	<!-- Slider -->
	<div class="block-slider block-slider4">
		<ul class="" id="bxslider-home4">
			<li>
				<img src="~/assets/user/img/h4-slide.png" alt="Slide">
				<div class="caption-group">
					<h2 class="caption title">
						iPhone <span class="primary">6 <strong>Plus</strong></span>
					</h2>
					<h4 class="caption subtitle">Dual SIM</h4>
					<a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
				</div>
			</li>
			<li><img src="~/assets/user/img/h4-slide2.png" alt="Slide">
				<div class="caption-group">
					<h2 class="caption title">
						by one, get one <span class="primary">50% <strong>off</strong></span>
					</h2>
					<h4 class="caption subtitle">school supplies & backpacks.*</h4>
					<a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
				</div>
			</li>
			<li><img src="~/assets/user/img/h4-slide3.png" alt="Slide">
				<div class="caption-group">
					<h2 class="caption title">
						Apple <span class="primary">Store <strong>Ipod</strong></span>
					</h2>
					<h4 class="caption subtitle">Select Item</h4>
					<a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
				</div>
			</li>
			<li><img src="~/assets/user/img/h4-slide4.png" alt="Slide">
				<div class="caption-group">
					<h2 class="caption title">
						Apple <span class="primary">Store <strong>Ipod</strong></span>
					</h2>
					<h4 class="caption subtitle">& Phone</h4>
					<a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
				</div>
			</li>
		</ul>
	</div>
	<!-- ./Slider -->
</div> <!-- End slider area -->

<div class="promo-area">
	<div class="zigzag-bottom"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-3 col-sm-6">
				<div class="single-promo promo1">
					<i class="fa fa-refresh"></i>
					<p>30 Days return</p>
				</div>
			</div>
			<div class="col-md-3 col-sm-6">
				<div class="single-promo promo2">
					<i class="fa fa-truck"></i>
					<p>Free shipping</p>
				</div>
			</div>
			<div class="col-md-3 col-sm-6">
				<div class="single-promo promo3">
					<i class="fa fa-lock"></i>
					<p>Secure payments</p>
				</div>
			</div>
			<div class="col-md-3 col-sm-6">
				<div class="single-promo promo4">
					<i class="fa fa-gift"></i>
					<p>New products</p>
				</div>
			</div>
		</div>
	</div>
</div> <!-- End promo area -->

@* Lastest Products *@
<div class="maincontent-area">
	<div class="zigzag-bottom"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="latest-product">
					<h2 class="section-title">Latest Products</h2>
					<div class="product-carousel">
						@foreach (var item in Model)
						{
							<div class="single-product">
								<div class="product-f-image">
									<img class="product-img" src="~/img/Products/@GetFirstImage(item.images)"
										alt="@item.productName" />
									<div class="product-hover">
										<a href="#" class="add-to-cart-link">
											<i class="fa fa-shopping-cart"></i> Add to cart
										</a>
										<a asp-controller="Product" asp-action="Details" asp-route-id="@item.productId"
											class="view-details-link">
											<i class="fa fa-link"></i> See details
										</a>
									</div>
								</div>

								<h2>
									<a asp-controller="Product" asp-action="Details" asp-route-id="@item.productId">
										@item.productName
									</a>
								</h2>

								<div class="product-carousel-price">
									@{
										var discountPrice = item.price - (item.price * item.discountPercentage / 100);
									}
									<ins>@discountPrice.ToString("N0") đ</ins>
									@if (item.discountPercentage > 0)
									{
										<del>@item.price.ToString("N0") đ</del>
									}
								</div>
							</div>
						}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="brands-area">
	<div class="zigzag-bottom"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="brand-wrapper">
					<div class="brand-list">
						<img src="~/assets/user/img/brand1.png" alt="">
						<img src="~/assets/user/img/brand2.png" alt="">
						<img src="~/assets/user/img/brand3.png" alt="">
						<img src="~/assets/user/img/brand4.png" alt="">
						<img src="~/assets/user/img/brand5.png" alt="">
						<img src="~/assets/user/img/brand6.png" alt="">
						<img src="~/assets/user/img/brand1.png" alt="">
						<img src="~/assets/user/img/brand2.png" alt="">
					</div>
				</div>
			</div>
		</div>
	</div>
</div> <!-- End brands area -->

@* Top Sellers *@
<div class="maincontent-area">
	<div class="zigzag-bottom"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="latest-product">
					<h2 class="section-title">Top Sellers</h2>
					<div class="product-carousel">
						@foreach (var item in Model)
						{
							<div class="single-product">
								<div class="product-f-image">
									<img class="product-img"
										src="~/img/Products/@item.images?.Split(',')[0].FirstOrDefault()"
										alt="@item.productName" />
									<div class="product-hover">
										<a href="#" class="add-to-cart-link">
											<i class="fa fa-shopping-cart"></i> Add to cart
										</a>
										<a asp-controller="Pro
																																												duct" asp-action="Details" asp-route-id="@item.productId"
											class="view-details-link">
											<i class="
																																													fa fa-link"></i> See details
										</a>
									</div>
								</div>

								<h2>
									<a asp-controller="Product" asp-action="Details" asp-route-id="@item.productId">
										@item.productName
									</a>
								</h2>

								<div class="product-carousel-price">
									@{
										var discountPrice = item.price - (item.price * item.discountPercentage / 100);
									}
									<ins>@discountPrice.ToString("N0") đ</ins>
									@if (item.discountPercentage > 0)
									{
										<del>@item.price.ToString("N0") đ</del>
									}
								</div>
							</div>
						}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

@* Top Views *@
<div class="maincontent-area">
	<div class="zigzag-bottom"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="latest-product">
					<h2 class="section-title">Top Views</h2>
					<div class="product-carousel">
						@foreach (var item in Model)
						{
							<div class="single-product">
								<div class="product-f-image">
									<img class="product-img"
										src="~/img/Products/@item.images?.Split(',')[0].FirstOrDefault()"
										alt="@item.productName" />
									<div class="product-hover">
										<a href="#" class="add-to-cart-link">
											<i class="fa fa-shopping-cart"></i> Add to cart
										</a>
										<a asp-controller="Pro
																																												duct" asp-action="Details" asp-route-id="@item.productId"
											class="view-details-link">
											<i class="
																																													fa fa-link"></i> See details
										</a>
									</div>
								</div>

								<h2>
									<a asp-controller="Product" asp-action="Details" asp-route-id="@item.productId">
										@item.productName
									</a>
								</h2>

								<div class="product-carousel-price">
									@{
										var discountPrice = item.price - (item.price * item.discountPercentage / 100);
									}
									<ins>@discountPrice.ToString("N0") đ</ins>
									@if (item.discountPercentage > 0)
									{
										<del>@item.price.ToString("N0") đ</del>
									}
								</div>
							</div>
						}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<style>
	.product-img {
		width: 220px;
		height: 280px;
		object-fit: contain;
	}
</style>

@section Script {
	<!-- Slider -->
	<script type="text/javascript" src="~/assets/user/js/bxslider.min.js"></script>
	<script type="text/javascript" src="~/assets/user/js/script.slider.js"></script>
}
