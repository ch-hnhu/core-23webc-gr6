@using core_23webc_gr6.Models
@model List<Product>
<!--PNSon 8/10/2025 sửa toàn bộ để phù hợp -->
@{
	ViewData["Title"] = "Danh sách sản phẩm";
	int page = ViewBag.Page ?? 1;
	int totalPages = ViewBag.TotalPages ?? 1;

	// Hiển thị tối đa 5 số trang quanh trang hiện tại
	int maxPagesToShow = 5;
	int startPage = Math.Max(1, page - maxPagesToShow / 2);
	int endPage = Math.Min(totalPages, startPage + maxPagesToShow - 1);
	if (endPage - startPage < maxPagesToShow - 1)
		startPage = Math.Max(1, endPage - maxPagesToShow + 1);
}

<div id="page-wrapper">
	<div class="container-fluid">
		<!--LTMKieu 6/10/2025-->
		<h2>Danh sách sản phẩm</h2>
		<table>
			<thead>
				<tr>
					<th>Mã sản phẩm</th>
					<th>Tên sản phẩm</th>
					<th>Mã danh mục</th>
					<th>Giá</th>
					<th>Giá khuyến mãi</th>
					<th>Số lượng tồn kho</th>
					<th>Hình ảnh</th>
					<th>Mô tả</th>
					<th>Trạng thái</th>
					<th>Ngày tạo</th>
					<th>Ngày cập nhật</th>
				</tr>
			</thead>
			@foreach (var product in Model)
			{
				<tr>
					<td>@product.ProductID</td>
					<td>@product.ProductName</td>
					<td>@product.CategoryID</td>
					<td>@product.Price.ToString()</td>
					<td>@product.DiscountPercentage.ToString()</td>
					<td>@product.Stock.ToString()</td>
					<td>
						<img src="@product.Image" alt="@product.ProductName" width="100" />
					</td>
					<td>@product.Description</td>
					<td>@product.Status.ToString()</td>
					<td>@product.CreatedAt.ToString("dd/MM/yyyy")</td>
					<td>@product.UpdatedAt.ToString("dd/MM/yyyy")</td>
				</tr>
			}

		</table>
		<!--endLTMKieu-->
		}



		<!--PNSon 8/10/2025 thêm CSS cho bảng-->
		<style>
			/* Định dạng bảng */
			table {
				width: 100%;
				border-collapse: collapse;
				margin: 20px 0;
				font-size: 14px;
				text-align: center;
				table-layout: auto;
			}

			/* Header */
			table thead th {
				background-color: #343a40;
				color: #fff;
				padding: 10px;
				border: 1px solid #ddd;
				white-space: nowrap;
			}

			/* Ô dữ liệu */
			table td {
				border: 1px solid #ddd;
				padding: 8px;
				vertical-align: middle;
				word-wrap: break-word;
				max-width: 250px;
			}

			/* Ảnh sản phẩm */
			table td img {
				display: block;
				margin: 0 auto;
				border-radius: 6px;
				width: 80px;
				height: auto;
				object-fit: cover;
				box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
			}

			/* Cột mô tả: cho phép xuống dòng và không bị tràn */
			table td:nth-child(8) {
				text-align: left;
				white-space: pre-wrap;
			}

			/* Cột giá, giá khuyến mãi, số lượng: canh giữa, đậm hơn 1 chút */
			table td:nth-child(4),
			table td:nth-child(5),
			table td:nth-child(6) {
				font-weight: 500;
				color: #212529;
			}

			/* Cột trạng thái: in đậm nếu cần */
			table td:nth-child(9) {
				font-weight: 600;
				color: #17a2b8;
			}

			/* Cột ngày tạo, ngày cập nhật: format nhỏ hơn 1 chút */
			table td:nth-child(10),
			table td:nth-child(11) {
				font-size: 13px;
				color: #6c757d;
			}

			/* Cột "Chi tiết": định dạng liên kết rõ hơn */
			table td:nth-child(12) a {
				color: #007bff;
				text-decoration: none;
				font-weight: 500;
			}

			table td:nth-child(12) a:hover {
				text-decoration: underline;
				color: #0056b3;
			}

			/* Tô màu xen kẽ */
			table tbody tr:nth-child(even) {
				background-color: #f8f9fa;
			}

			/* Hover */
			table tbody tr:hover {
				background-color: #e9ecef;
				transition: 0.2s;
			}
		</style>


		@*  Phân trang *@
		@if (totalPages > 1)
		{
			<nav aria-label="Phân trang sản phẩm">
				<ul class="pagination">

					@* Trang đầu *@
					<li class="page-item @(page == 1 ? "disabled" : "")">
						<a class="page-link" href="@Url.Action("Index", "Product", new { area = "Admin", page = 1 })">«
							Đầu</a>
					</li>

					@* Lùi *@
					<li class="page-item @(page <= 1 ? "disabled" : "")">
						<a class="page-link"
							href="@Url.Action("Index", "Product", new { area = "Admin", page = page - 1 })">‹</a>
					</li>

					@for (int i = startPage; i <= endPage; i++)
					{
						<li class="page-item @(i == page ? "active" : "")">
							<a class="page-link" href="@Url.Action("Index", "Product", new { area = "Admin", page = i })">@i</a>
						</li>
					}

					@* Tiến *@
					<li class="page-item @(page >= totalPages ? "disabled" : "")">
						<a class="page-link"
							href="@Url.Action("Index", "Product", new { area = "Admin", page = page + 1 })">›</a>
					</li>

					@* Trang cuối *@
					<li class="page-item @(page == totalPages ? "disabled" : "")">
						<a class="page-link"
							href="@Url.Action("Index", "Product", new { area = "Admin", page = totalPages })">Cuối »</a>
					</li>
				</ul>
				<div class="text-center mt-2 text-muted">
					Trang <strong>@(page)</strong> / <strong>@(totalPages)</strong>
				</div>
			</nav>
		}
	</div>

	@* Nút cố định góc phải dưới *@
	<a class="floating-add-button" href="@Url.Action("AddProduct", "Product", new { area = "Admin" })">
		Thêm sản phẩm
	</a>
</div>


<style>
	#page-wrapper {
		margin-left: 220px;
		padding: 20px;
		min-height: 100vh;
		background: #f8f9fa;
		position: relative;
	}

	.pagination {
		margin-top: 25px;
		display: flex;
		justify-content: center;
		align-items: center;
		flex-wrap: wrap;
	}

	.pagination li {
		margin: 0 2px;
	}

	.pagination .page-item.disabled .page-link {
		color: #aaa;
		pointer-events: none;
		background-color: #f8f9fa;
	}

	.pagination .page-item.active .page-link {
		background-color: #007bff;
		color: #fff;
		border-color: #007bff;
	}

	.pagination .page-link {
		color: #007bff;
		border: 1px solid #dee2e6;
		padding: 6px 12px;
		border-radius: 4px;
		transition: background-color 0.2s;
	}

	.pagination .page-link:hover {
		background-color: #e9ecef;
	}

	.floating-add-button {
		position: fixed;
		bottom: 25px;
		right: 30px;
		background-color: #007bff;
		color: #fff;
		border: none;
		border-radius: 50px;
		padding: 12px 22px;
		font-size: 16px;
		font-weight: 600;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
		cursor: pointer;
		transition: all 0.25s ease-in-out;
		z-index: 999;
		text-decoration: none;
	}

	.floating-add-button:hover {
		background-color: #0056b3;
		transform: translateY(-2px);
	}
</style>
